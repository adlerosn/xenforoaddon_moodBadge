<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="moodBadge" title="Mood Badge by kiror" version_string="0.0" version_id="0" url="https://github.com/adlerosn/" install_callback_class="moodBadge_setup" install_callback_method="install" uninstall_callback_class="moodBadge_setup" uninstall_callback_method="uninstall">
  <admin_navigation/>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates/>
  <admin_template_modifications/>
  <code_events/>
  <code_event_listeners/>
  <cron/>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups/>
  <permissions>
    <permission_groups/>
    <permissions/>
    <interface_groups/>
  </permissions>
  <phrases/>
  <route_prefixes>
    <route_type type="public">
      <prefix original_prefix="moodchanging" class="moodBadge_routeinterface" build_link="none"/>
    </route_type>
  </route_prefixes>
  <style_properties/>
  <templates>
    <template title="kiror_floating_mood_changer" version_id="0" version_string="0.0"><![CDATA[<xen:title>Mood changer</xen:title>

<xen:container var="$head.metaNoindex"><meta name="robots" content="noindex" /></xen:container>

<xen:require css="kiror_floating_mood_changer.css" />
<xen:require css="chooser_overlay.css" />
<xen:require css="style_chooser.css" />

<div class="section styleChooser" data-overlayClass="chooserOverlay">

	<h3 class="subHeading">Select your mood to be displayed on the site</h3>
	
	<ol class="primaryContent chooserColumns twoColumns overlayScroll">
	
		{xen:raw $html}

	</ol>

	<div class="sectionFooter overlayOnly"><a class="button primary OverlayCloser">{xen:phrase cancel}</a></div>
</div>]]></template>
    <template title="kiror_floating_mood_changer.css" version_id="0" version_string="0.0"><![CDATA[.changerSelected{
	background-color: {xen:property secondaryLightest};
	text-decoration: none;
}]]></template>
  </templates>
  <public_template_modifications>
    <modification template="navigation_visitor_tab" modification_key="insertcurrentmoodaccountmenu" description="Inserts current mood in account menu" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if hascontent="true"><div class="muted"><xen:contentcheck>{xen:helper usertitle, $visitor}</xen:contentcheck></div></xen:if>]]></find>
      <replace><![CDATA[<xen:if hascontent="true"><div class="muted"><xen:contentcheck>{xen:helper usertitle, $visitor}</xen:contentcheck></div></xen:if>

<xen:callback class="moodBadge_sharedStatic" method="getMoodTitleLowerIfDefinedCallback" params="{xen:array 'uid={$visitor.user_id}','aft=</i></div>','pre=<div class="muted">Feeling <i>'}"></xen:callback>]]></replace>
    </modification>
    <modification template="footer" modification_key="insertcurrentmoodfooterlink" description="Inserts current mood changer link in footer" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if is="{$canChangeLanguage}">
					<dt>{xen:phrase language}</dt>
					<dd><a href="{xen:link 'misc/language', '', 'redirect={$requestPaths.requestUri}'}" class="OverlayTrigger Tooltip" title="{xen:phrase language_chooser}" rel="nofollow">{$visitorLanguage.title}</a></dd>
				</xen:if>]]></find>
      <replace><![CDATA[<xen:if is="{$canChangeLanguage}">
					<dt>{xen:phrase language}</dt>
					<dd><a href="{xen:link 'misc/language', '', 'redirect={$requestPaths.requestUri}'}" class="OverlayTrigger Tooltip" title="{xen:phrase language_chooser}" rel="nofollow">{$visitorLanguage.title}</a></dd>
				</xen:if>
<xen:if is="{$visitor.user_id}">
<dt>Mood</dt>
<dd><a href="{xen:link 'moodchanging', '', 'redirect={$requestPaths.requestUri}'}" class="OverlayTrigger Tooltip" title="Mood changer" rel="nofollow">Mood</a></dd>
</xen:if>]]></replace>
    </modification>
    <modification template="member_card" modification_key="insertcurrentmoodmembercard" description="Inserts current mood in member card" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[</xen:if>
	</div>
	
	<a class="close OverlayCloser"></a>]]></find>
      <replace><![CDATA[<xen:callback class="moodBadge_sharedStatic" method="getMoodTitleLowerIfDefinedCallback" params="{xen:array 'uid={$user.user_id}','aft=</i></div>','pre=<div class="muted">{$user.username} is feeling <i>'}"></xen:callback>
		</xen:if>
	</div>
	
	<a class="close OverlayCloser"></a>]]></replace>
    </modification>
    <modification template="member_view" modification_key="insertcurrentmoodmemberview" description="Inserts current mood in member view" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[</div>
			
			<ul class="tabs mainTabs Tabs" data-panes="#ProfilePanes > li" data-history="on">]]></find>
      <replace><![CDATA[<xen:callback class="moodBadge_sharedStatic" method="getMoodTitleLowerIfDefinedCallback" params="{xen:array 'uid={$user.user_id}','aft=</i></div>','pre=<div class="muted lastActivity" style="border-top: 0px; padding-top: 0px; margin-top: 1px;">{$user.username} is feeling <i>'}"></xen:callback>
			</div>
			
			<ul class="tabs mainTabs Tabs" data-panes="#ProfilePanes > li" data-history="on">]]></replace>
    </modification>
    <modification template="message_user_info" modification_key="insertcurrentmoodthreadreply" description="Inserts current mood in sidebar from thread reply" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<!-- slot: message_user_info_text -->]]></find>
      <replace><![CDATA[<dl class="pairsJustified" title="<xen:callback class="moodBadge_sharedStatic" method="getMoodTitleCallback" params="{xen:array 'uid={$user.user_id}'}"></xen:callback>">
	<dt>Mood:</dt>
	<dd><xen:callback class="moodBadge_sharedStatic" method="getMoodCharCallback" params="{xen:array 'uid={$user.user_id}'}"></xen:callback></dd>
</dl>
<!-- slot: message_user_info_text -->]]></replace>
    </modification>
    <modification template="navigation_visitor_tab" modification_key="insertmoodchanginglinkinaccountmenu" description="Inserts mood changing link in account menu" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if is="{$canEditProfile}"><li><a href="{xen:link account/personal-details}">{xen:phrase personal_details}</a></li></xen:if>]]></find>
      <replace><![CDATA[<xen:if is="{$canEditProfile}"><li><a href="{xen:link account/personal-details}">{xen:phrase personal_details}</a></li></xen:if>
<li><a href="{xen:link 'moodchanging', '', 'redirect={$requestPaths.requestUri}'}" class="OverlayTrigger Tooltip" rel="nofollow">Mood displayed</a></li>]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
  <bb_codes/>
</addon>
